# 美剧、三个问题和密码管理器

## 美剧

最近看了知乎上的《绝命毒师》剧情解析专栏《八周影记》，被作者细致入微且专业的分析折服。于是又开始继续补之前还没看的第5季。

第1集里有个情节是这样的：

刚刚干掉毒枭大boss的两人，正准备欢庆新生（两人笼罩在大boss的阴影下很久，且大boss正准备让他们其中一人消失）。但是，他们很快意识到他们帮大boss制毒的监控视频就存在电脑里， 更糟糕的是，大boss的电脑被警察局收走作为证物了。如果警察看到视频内容，他们就完了。

于是，他们想尽办法搞到了警察局存放笔记本的位置，最后想到用电磁感应搞出来一个超大磁铁破坏证物。在执行计划的时候，为求更大的确定性，他们差点被警察抓走。

得知证物已损坏（屏幕碎裂）的缉毒警察汉克，先表示当时看着证物被其他警察拿走的时候他就一心不舍，颇有“要是证物在我们这儿就好了，要是在我这里就不会有这事”的感觉。结果，它最后冷不丁来一句：“其实电脑里的数据都是加密的，即使我们拿到也看不到里面的东西”。

这……幸亏他们不知道这事，否则要一墙撞死。更糟糕的是，这次破坏阴差阳错地暴露了其他本来没被发现的证据……这是《绝命毒师》里随处可见的反差、伏笔设计，也是这部美剧受到好评的原因之一。

不过，今天的重点不是推荐美剧和剧评，而是汉克说的：“笔记本里的数据是加密的，所以拿到了也看不了”。

## 三个问题

为什么我突然开始对这句话感兴趣了呢？

周六，我花了大半天，折腾密码管理器的事情，也因此我开始尝试学习一些加密相关的知识。由于学习的过程比较艰难，我又看了1集剧。不知不觉地，我脑子里一些原本分散存在的神经突然被关联了起来。本来我毫不在意的东西，开始变成我脑子里的不停闪现的问题：

1. **我们经常在电影电视里看到这样的画面，一个人把usb插进电脑，然后屏幕突然就滚动一个进度条或者百分比，表明正在拷贝数据。有的时候不用电脑登录密码就可以做到这样，这可能么？**
2. **听汉克的意思，炸鸡叔的笔记本电脑加密了数据就没法看了。他说的加密是啥意思，不是电脑登录密码吧？如果问题1是可行的，这号称“有史以来最伟大的电视剧之一”是在诓我们？不会的不会的，他们不会犯这么低级的错误……**

3. **换个角度，像视频这样比较大的数据，我们一般会保存在硬盘里。显示器坏了的话，把硬盘拆下来换个显示器好的机器，硬盘接上不就可以读取查看了么？**

于是，我又花了半天时间来解决这些疑问。

在搜索问题1的答案时，有一瞬间突然觉得：自己在干一点像“黑客”的事情了。

说来惭愧，自己当了这么多年程序员（工作3年+学生时代4年），但是脑子里对“黑客”的看法依然局限——似乎得搞加密解密的程序员才是黑客，夸张一点说，“入侵计算机的人才是黑客”。

顺便借《黑客与画家》里的内容科普一下。其实hacker的起源是这样：

> 1946年，第一台电子计算机ENIAC在美国诞生，从此世界上一些最聪明、最有创造力的人开始进入这个行业，在他们身上逐渐地形成了一种独特的技术文化。在这种文化的发展过程中，涌现了很多“行话”（jargon）。20世纪60年代初，麻省理工学院有一个学生团体叫做“铁路模型技术俱乐部”（Tech Model Railroad Club，简称TMRC），他们把难题的解决方法称为hack。
>
> hack的字典解释是砍（木头），在这些学生看来，解决一个计算机难题就好像砍倒一棵大树。那么相应地，完成这种hack 的过程就被称为hacking，而从事hacking 的人就是hacker，也就是黑客。

作为入门hacker，我的hacking方式很简单——Google搜索“copy data  from locked computer”。结果有点让我出乎意料，因为解决方案似乎太简单了，绝大多数自己装过Linux系统(e.g. Ubuntu)的小伙伴应该都具备影视剧里的能力。

> 做一个linux系统的usb启动盘，然后启动usb里的linux系统，把机器里的硬盘挂载上，就可以读取、拷贝电脑里数据了。

不熟悉的小伙伴可能看不懂。总而言之，理论上，在不用登陆密码的情况下，只用一个usb是有可能从一台锁屏电脑里拷贝数据的（问题1解决了）。

但是，这么做有效的前提是：硬盘数据没有被加密。

因为数据可以拷走，不代表代表有能力可以正确读取这些数据。举个例子，即使汉克有幸拿到了电脑，而且电脑也没有被老白等人破坏。甚至，他还有个“黑客”帮忙，再不用登录密码的情况下把数据复制出来了。可是，他可能只能看到一堆这样的文件：haha.you.can.not.parser.me.xx（这个名字是我杜撰的）。这样的文件就是一种被加密过后的文件，如文件名所言，根本没法直接打开查看

更高级的加密方法，甚至可以直接禁止复制、删除特定的数据。于是，问题2也解决了：炸鸡叔自然是使用高级的硬盘加密功能了。

由于我们验证了问题1，所以问题3和问题2其实是一样的了。且不说能不能拿到数据，即使拿到数据没有用，得拿到可以正常读取的数据才行。所以把硬盘拆下来，接到其他机器上，也不一定能正常打开里面的数据。

好了，到此为止三个问题就解决了。但是，新的问题又蹦出来了：听起来，给硬盘里的数据加密是一个非常复杂、很有技术难度的活？毕竟只有炸鸡叔这样的大boss才这么干。

事实上呢？我们的电脑&手机就提供了硬盘加密功能。大多数人不知道，大概率是因为没需求而已。比如mac就提供了一个FileVault(文件保险箱)功能。打开设置->安全->文件保险箱就可以开启。

<img src="https://i.loli.net/2021/11/14/Cn1JNrH4GOzRvtD.png" alt="img" style="zoom:100%;" />

<img src="https://i.loli.net/2021/11/14/CPduR31IAczEH9V.png" alt="image-20211114090649776" style="zoom:35%;" />

如上图所示，这个文件保险箱功能，能够保证在锁屏状态下，不知道登录密码的人，无法查看和拷贝数据。

为了测试这个加密之后是否影响正常使用，尽管没有所谓公司的财务数据，我依然打开了这个功能。第一次加密需要比较久的时间，因为要对当前硬盘里的数据都进行加密。我500G左右的硬盘基本装满了，花了大概5h。但是之后速度会快一些，因为只会对新的数据加密。而且之后的加密过程是后台自动运行的，所以其实快慢也无所谓。

结束加密后，我的电脑重启了，这次重启花了很长的时间，不过我不确定是加密都导致的还是我电脑自动更新软件了。于是我又重启了一下，速度比往常慢了一点点但是基本没差别。

回到我最开始的目的，测试发现：**开启这个功能之后，文件打开、使用的的方式和之前没有差别**。只是再次重启时，会有一个提醒：

同样的，微软win10系统也自带硬盘加密功能——Windows BitLocker，感兴趣的可以去搜一下。

## 密码管理器

前面说到我周末花了大半天折腾“密码管理器”。这是个什么东西呢？

> 密码管理器或密钥管理员是一类用于生成、检索、保存及管理复杂密码、数字签名的措施，可以由硬件或软件实现。复杂密码的生成一般按需要以随机算法产生，而密码资料则保存于一个以密码、数字签名等方式加密的数据库内。
>
> 它的作用类似于钥匙圈，方便个人或企业组织集中管理密码、数字签名等身份管理要素。

对我来说，它就是一个密码生成器和密码托管工具。

之所以做这件事，最主要的原因是我经常记不住自己的密码，即使我为了方便记忆使用的密码并不多，且有一定规律。以致于我经常不得不重置部分网站的密码。这事虽然是个小事，但是往往需要账号密码的时候，都是比较紧急的时候。比如网站要求登录才能看回答，要求登录才能下载特定软件……

出于方便考虑，我使用了google浏览器自带的密码管理器。但是时间救了我发现，它经常一个网站记录好几个不同密码。

糟糕的是，我又总是不记得对谷歌浏览器保存的密码进行去重。于是，我一次又一次面临同样的问题……

还有呢，浏览器密码管理器只能管理网页密码，而我在手机app上也有类似的困扰（虽然大部分都可以用重置密码，或者人脸识别登录解决）。

另一个重要原因是：为了简化记忆，我在各个app、网站上经常重用密码，这存在安全隐患（见“密码重用的危害及规避方法”）。简单来说，恶意攻击者有可能会使用“撞库攻击”：即在一个网站上破解你的密码后，把这个账户密码保存下来，在无数其他网站上也尝试使用。如果恰巧你的银行账户或者其他一些包含重要个人信息的网站也用了类似的密码，那还是挺危险的。尤其是在区块链技术快速发展的今天和未来，你的资产可能就是一串数字……

我用的是付费密码管理器1 password，花了大半天，终于把电脑和手机上的大部分我觉得有必要的密码，都换成这个软件自动生成和管理的。这事本身不复杂（安装软件、重置密码然后保存密码），但是比较繁琐。

在使用1 password的过程中， 我读了几篇他们官网的文章、国内的一些关于1password的使用测评，还有几篇关于密码管理器发展历史的文章。关于1 password使用，直接看官网材料就好了。

有两篇密码管理器的发展史的文章倒是很推荐：密码管理器的进化史（上）和密码管理器的进化史（下）。这两篇文章不仅给我扫盲了密码管理器的发展史，还解决了我对密码管理器是否安全的担心。

## 参考文献

- How does FileVault encryption work on a Mac? https://support.apple.com/en-gb/guide/mac-help/flvlt001/12.0/mac/12.0

- 做好个人数据与隐私防护，从这份检查清单开始 https://sspai.com/post/56066

- http://earthnewspapers.com/blog/how-to-copy-files-from-a-locked-computer/

  > 用一个use live linux系统，就可以访问一个locked computer的磁盘内容

- https://www.quora.com/How-would-one-recover-data-from-a-locked-computer

  > 从复原数据的角度说如何从锁屏电脑里获取数据。和上一篇说的差不多，用一个live linux USB就可以访问/复制整个磁盘，甚至加密磁盘，只是加密磁盘可能看不了数据。

- https://blog.comodo.com/pc-security/stealing-data-from-locked-pcs-possible-using-usb-device/
  > usb是即插即用的，即使在计算机被锁定的情况下，usb驱动也会自动安装。即使在比较新的系统里，像以太网口这种肯定在禁止自动安装的白名单里。所以，usb伪装成一个以太网设备(USB Ethernet adapter)就好了

  > This means that even if a system is locked out, the device still gets installed. Now, I believe there are restrictions on what types of devices are allowed to install at a locked out state on newer operating systems (Win10/El Capitan), but Ethernet/LAN is definitely on the white list

  > 根据Rob-fuller所说，他最快可以在15s内获取计算机内的账号hashed密码信息。有些hashed code很难破解，但是有些很容易，有些甚至不用破解就可以拿去使用。

- 密码管理器的进化史（上）https://cloud.tencent.com/developer/news/591925 

- 密码管理器的进化史（下）https://cloud.tencent.com/developer/news/595746

